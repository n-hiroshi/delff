<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>delff package &mdash; delff  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to delff’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            delff
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">delff package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.bonding_energy">delff.bonding_energy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.bonding_energy.angle_energy"><code class="docutils literal notranslate"><span class="pre">angle_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.bonding_energy.bond_energy"><code class="docutils literal notranslate"><span class="pre">bond_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.bonding_energy.dihedral_energy"><code class="docutils literal notranslate"><span class="pre">dihedral_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.bonding_energy.improper_energy"><code class="docutils literal notranslate"><span class="pre">improper_energy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.dataclasses">delff.dataclasses module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.dataclasses.dataclass"><code class="docutils literal notranslate"><span class="pre">dataclass()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.dataclasses.static_field"><code class="docutils literal notranslate"><span class="pre">static_field()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.delff_lat">delff.delff_lat module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.alldists_lat"><code class="docutils literal notranslate"><span class="pre">alldists_lat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.draw_pes"><code class="docutils literal notranslate"><span class="pre">draw_pes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.noopt"><code class="docutils literal notranslate"><span class="pre">noopt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.prepare"><code class="docutils literal notranslate"><span class="pre">prepare()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.save_to_gjf_lmp"><code class="docutils literal notranslate"><span class="pre">save_to_gjf_lmp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.delff_lat.search_neighbors"><code class="docutils literal notranslate"><span class="pre">search_neighbors()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.energy">delff.energy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.energy.energy"><code class="docutils literal notranslate"><span class="pre">energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.energy.energy_coord"><code class="docutils literal notranslate"><span class="pre">energy_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.energy.energy_each"><code class="docutils literal notranslate"><span class="pre">energy_each()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.energy.energy_each_coord"><code class="docutils literal notranslate"><span class="pre">energy_each_coord()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.evalfunc">delff.evalfunc module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_Ulattice"><code class="docutils literal notranslate"><span class="pre">L_Ulattice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_Ulattice_tgt"><code class="docutils literal notranslate"><span class="pre">L_Ulattice_tgt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_force"><code class="docutils literal notranslate"><span class="pre">L_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_pes"><code class="docutils literal notranslate"><span class="pre">L_pes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_sum"><code class="docutils literal notranslate"><span class="pre">L_sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_sys"><code class="docutils literal notranslate"><span class="pre">L_sys()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.evalfunc.L_sys_lat"><code class="docutils literal notranslate"><span class="pre">L_sys_lat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.gaussianff">delff.gaussianff module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.gaussianff.get_ref_sys_and_energies"><code class="docutils literal notranslate"><span class="pre">get_ref_sys_and_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.gaussianff.get_sys_from_gjf"><code class="docutils literal notranslate"><span class="pre">get_sys_from_gjf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.gaussianff.get_sys_from_log"><code class="docutils literal notranslate"><span class="pre">get_sys_from_log()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.gaussianff.write_gjf"><code class="docutils literal notranslate"><span class="pre">write_gjf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.gaussianhandler">delff.gaussianhandler module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.gaussianhandler.GaussianHandler"><code class="docutils literal notranslate"><span class="pre">GaussianHandler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.gaussianhandler.GaussianHandler.get_coord_log"><code class="docutils literal notranslate"><span class="pre">GaussianHandler.get_coord_log()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.gaussianhandler.GaussianHandler.get_info"><code class="docutils literal notranslate"><span class="pre">GaussianHandler.get_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.gaussianhandler.GaussianHandler.get_system"><code class="docutils literal notranslate"><span class="pre">GaussianHandler.get_system()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.lammpsff">delff.lammpsff module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.generate_scale_mat"><code class="docutils literal notranslate"><span class="pre">generate_scale_mat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.make_atomtypelabels"><code class="docutils literal notranslate"><span class="pre">make_atomtypelabels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.make_nbcharges"><code class="docutils literal notranslate"><span class="pre">make_nbcharges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.make_nbmasses"><code class="docutils literal notranslate"><span class="pre">make_nbmasses()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.make_nbpairs"><code class="docutils literal notranslate"><span class="pre">make_nbpairs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.read_system"><code class="docutils literal notranslate"><span class="pre">read_system()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.read_system_data"><code class="docutils literal notranslate"><span class="pre">read_system_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.read_system_in_settings"><code class="docutils literal notranslate"><span class="pre">read_system_in_settings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.write_system_data"><code class="docutils literal notranslate"><span class="pre">write_system_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.lammpsff.write_system_in_settings"><code class="docutils literal notranslate"><span class="pre">write_system_in_settings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.metaopt">delff.metaopt module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.metaopt.doreg_and_mask_bounds"><code class="docutils literal notranslate"><span class="pre">doreg_and_mask_bounds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.metaopt.metaopt"><code class="docutils literal notranslate"><span class="pre">metaopt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.metaopt.set_bounds"><code class="docutils literal notranslate"><span class="pre">set_bounds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.metaopt.set_mask"><code class="docutils literal notranslate"><span class="pre">set_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.nonbonding_energy">delff.nonbonding_energy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.calc_coulomb"><code class="docutils literal notranslate"><span class="pre">calc_coulomb()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.calc_vdw"><code class="docutils literal notranslate"><span class="pre">calc_vdw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.charmm_Sfactor"><code class="docutils literal notranslate"><span class="pre">charmm_Sfactor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.nonbond_energy"><code class="docutils literal notranslate"><span class="pre">nonbond_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.nonbond_energy_allpairs"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_allpairs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy.nonbond_energy_intramol_correction"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_intramol_correction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.nonbonding_energy_ewald">delff.nonbonding_energy_ewald module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_ewald.calc_coulomb_long_all"><code class="docutils literal notranslate"><span class="pre">calc_coulomb_long_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_ewald.calc_coulomb_self"><code class="docutils literal notranslate"><span class="pre">calc_coulomb_self()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_ewald.calc_coulomb_short"><code class="docutils literal notranslate"><span class="pre">calc_coulomb_short()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_ewald.nonbond_energy_ewald"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_ewald()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_ewald.nonbond_energy_ewald_wo_intramol_correction"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_ewald_wo_intramol_correction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.nonbonding_energy_neighbors">delff.nonbonding_energy_neighbors module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_neighbors.nonbond_energy_allneighbors"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_allneighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.nonbonding_energy_neighbors.nonbond_energy_neighbors"><code class="docutils literal notranslate"><span class="pre">nonbond_energy_neighbors()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.objects">delff.objects module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.ForceField"><code class="docutils literal notranslate"><span class="pre">ForceField</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.angletypes"><code class="docutils literal notranslate"><span class="pre">ForceField.angletypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.bondtypes"><code class="docutils literal notranslate"><span class="pre">ForceField.bondtypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.charges"><code class="docutils literal notranslate"><span class="pre">ForceField.charges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.cscale3"><code class="docutils literal notranslate"><span class="pre">ForceField.cscale3</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.dielectric_constant"><code class="docutils literal notranslate"><span class="pre">ForceField.dielectric_constant</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.dihedralks"><code class="docutils literal notranslate"><span class="pre">ForceField.dihedralks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.impropertypes"><code class="docutils literal notranslate"><span class="pre">ForceField.impropertypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.pairs"><code class="docutils literal notranslate"><span class="pre">ForceField.pairs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceField.vscale3"><code class="docutils literal notranslate"><span class="pre">ForceField.vscale3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.ForceFieldAssignments"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.adjmat012"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.adjmat012</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.adjmat3"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.adjmat3</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.alpha_ewald"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.alpha_ewald</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.angles"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.atomtypes"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.atomtypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.bonds"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.bonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.ccutoff"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.ccutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.dihedralmasks"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.dihedralmasks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.dihedralphis"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.dihedralphis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.dihedrals"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.dihedrals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.impropers"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.impropers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.intermol_dists"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.intermol_dists</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.latidx"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.latidx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.masses"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.masses</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.natomvec"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.natomvec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.nbatomtypesets"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.nbatomtypesets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.neighbors"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.neighbors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.nkmaxs"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.nkmaxs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.nkvecs"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.nkvecs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.nmolvec"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.nmolvec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.sigma_ewald"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.sigma_ewald</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.ForceFieldAssignments.vcutoff"><code class="docutils literal notranslate"><span class="pre">ForceFieldAssignments.vcutoff</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.RTPCoord"><code class="docutils literal notranslate"><span class="pre">RTPCoord</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.RTPCoord.phids"><code class="docutils literal notranslate"><span class="pre">RTPCoord.phids</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.RTPCoord.phiis"><code class="docutils literal notranslate"><span class="pre">RTPCoord.phiis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.RTPCoord.rall"><code class="docutils literal notranslate"><span class="pre">RTPCoord.rall</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.RTPCoord.rs"><code class="docutils literal notranslate"><span class="pre">RTPCoord.rs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.RTPCoord.thetas"><code class="docutils literal notranslate"><span class="pre">RTPCoord.thetas</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.System.coord"><code class="docutils literal notranslate"><span class="pre">System.coord</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.System.lattice"><code class="docutils literal notranslate"><span class="pre">System.lattice</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.Task"><code class="docutils literal notranslate"><span class="pre">Task</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.Task.Ltype"><code class="docutils literal notranslate"><span class="pre">Task.Ltype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#delff.objects.Task.params"><code class="docutils literal notranslate"><span class="pre">Task.params</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#delff.objects.update"><code class="docutils literal notranslate"><span class="pre">update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.opt">delff.opt module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt.ilu"><code class="docutils literal notranslate"><span class="pre">ilu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt.opt_sys_jaxopt"><code class="docutils literal notranslate"><span class="pre">opt_sys_jaxopt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt.opt_sys_jvp"><code class="docutils literal notranslate"><span class="pre">opt_sys_jvp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.opt_lat">delff.opt_lat module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt_lat.ilu"><code class="docutils literal notranslate"><span class="pre">ilu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt_lat.opt_lat_sys_jaxopt"><code class="docutils literal notranslate"><span class="pre">opt_lat_sys_jaxopt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.opt_lat.opt_lat_sys_jvp"><code class="docutils literal notranslate"><span class="pre">opt_lat_sys_jvp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.params_ewald">delff.params_ewald module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.params_ewald.calc_kvecs_combinatorial"><code class="docutils literal notranslate"><span class="pre">calc_kvecs_combinatorial()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.params_ewald.calc_nkvecs"><code class="docutils literal notranslate"><span class="pre">calc_nkvecs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.params_ewald.define_ewald_params"><code class="docutils literal notranslate"><span class="pre">define_ewald_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.rtp">delff.rtp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.alldists"><code class="docutils literal notranslate"><span class="pre">alldists()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.alldists_neighbors"><code class="docutils literal notranslate"><span class="pre">alldists_neighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.angle_coord"><code class="docutils literal notranslate"><span class="pre">angle_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.bond_coord"><code class="docutils literal notranslate"><span class="pre">bond_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.dihedral_coord"><code class="docutils literal notranslate"><span class="pre">dihedral_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.improper_coord"><code class="docutils literal notranslate"><span class="pre">improper_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.xyz2rtp"><code class="docutils literal notranslate"><span class="pre">xyz2rtp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.rtp.xyz2rtp_lattice"><code class="docutils literal notranslate"><span class="pre">xyz2rtp_lattice()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff.util">delff.util module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.convert_tsr4_to_mat2"><code class="docutils literal notranslate"><span class="pre">convert_tsr4_to_mat2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.doreg"><code class="docutils literal notranslate"><span class="pre">doreg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.dounreg"><code class="docutils literal notranslate"><span class="pre">dounreg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.get_reciprocal_lattice_and_V"><code class="docutils literal notranslate"><span class="pre">get_reciprocal_lattice_and_V()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.isfloat"><code class="docutils literal notranslate"><span class="pre">isfloat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.jnp2np"><code class="docutils literal notranslate"><span class="pre">jnp2np()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.logdamp"><code class="docutils literal notranslate"><span class="pre">logdamp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.logdamp_np"><code class="docutils literal notranslate"><span class="pre">logdamp_np()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.make_lattice_replicas"><code class="docutils literal notranslate"><span class="pre">make_lattice_replicas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.np2jnp"><code class="docutils literal notranslate"><span class="pre">np2jnp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.print_jnpval"><code class="docutils literal notranslate"><span class="pre">print_jnpval()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delff.util.printff"><code class="docutils literal notranslate"><span class="pre">printff()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-delff">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">delff</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">delff package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/delff.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="delff-package">
<h1>delff package<a class="headerlink" href="#delff-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-delff.bonding_energy">
<span id="delff-bonding-energy-module"></span><h2>delff.bonding_energy module<a class="headerlink" href="#module-delff.bonding_energy" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.bonding_energy.angle_energy">
<span class="sig-prename descclassname"><span class="pre">delff.bonding_energy.</span></span><span class="sig-name descname"><span class="pre">angle_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/bonding_energy.html#angle_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.bonding_energy.angle_energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total angle energy of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total angle energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.bonding_energy.bond_energy">
<span class="sig-prename descclassname"><span class="pre">delff.bonding_energy.</span></span><span class="sig-name descname"><span class="pre">bond_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/bonding_energy.html#bond_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.bonding_energy.bond_energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total bond energy of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total bond energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.bonding_energy.dihedral_energy">
<span class="sig-prename descclassname"><span class="pre">delff.bonding_energy.</span></span><span class="sig-name descname"><span class="pre">dihedral_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/bonding_energy.html#dihedral_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.bonding_energy.dihedral_energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total dihedral energy of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total dihedral energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.bonding_energy.improper_energy">
<span class="sig-prename descclassname"><span class="pre">delff.bonding_energy.</span></span><span class="sig-name descname"><span class="pre">improper_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/bonding_energy.html#improper_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.bonding_energy.improper_energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total improper energy of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total improper energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.dataclasses">
<span id="delff-dataclasses-module"></span><h2>delff.dataclasses module<a class="headerlink" href="#module-delff.dataclasses" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.dataclasses.dataclass">
<span class="sig-prename descclassname"><span class="pre">delff.dataclasses.</span></span><span class="sig-name descname"><span class="pre">dataclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/dataclasses.html#dataclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.dataclasses.dataclass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.dataclasses.static_field">
<span class="sig-prename descclassname"><span class="pre">delff.dataclasses.</span></span><span class="sig-name descname"><span class="pre">static_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/dataclasses.html#static_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.dataclasses.static_field" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-delff.delff_lat">
<span id="delff-delff-lat-module"></span><h2>delff.delff_lat module<a class="headerlink" href="#module-delff.delff_lat" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.alldists_lat">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">alldists_lat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/delff_lat.html#alldists_lat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.alldists_lat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.draw_pes">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">draw_pes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pes_dirs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#draw_pes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.draw_pes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.noopt">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">noopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#noopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.noopt" title="Permalink to this definition"></a></dt>
<dd><p>The function noopt() evaluates the force field after optimization by
calculating the L_sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff_ini</strong> – a dictionary containing the initial force field parameters.</p></li>
<li><p><strong>work</strong> – a dictionary containing information about the optimization work.</p></li>
<li><p><strong>algo</strong> – a string specifying the optimization algorithm to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function does not explicitly return any value,
but it prints the calculated value of the L_sum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.prepare">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_balance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taskids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monomer_gjf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_settings_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_ff_load</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_balance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1],</span> <span class="pre">dtype=int64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_gjf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ulattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pes_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_ewald</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkmaxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">dtype=int64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.prepare" title="Permalink to this definition"></a></dt>
<dd><p>The function prepare is used to prepare the input for the force field optimization.
It takes multiple arguments and returns a dictionary containing relevant information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>str</em>) – the directory where the optimization is run</p></li>
<li><p><strong>name</strong> (<em>str</em>) – the name of the optimization</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – an integer index of the optimization</p></li>
<li><p><strong>task_balance</strong> (<em>numpy.ndarray</em>) – an array of integers</p></li>
<li><p><strong>task</strong> (<em>specifying the weights</em><em> of </em><em>each</em>) – </p></li>
<li><p><strong>taskids</strong> (<em>list</em>) – a list of integers representing the ids of tasks to perform</p></li>
<li><p><strong>monomer_gjf</strong> (<em>str</em>) – the path of the Gaussian input file for the monomer</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em>) – a list of sets containing the names of the atoms</p></li>
<li><p><strong>molecule</strong> (<em>in each type of</em>) – </p></li>
<li><p><strong>in_settings_file</strong> (<em>str</em>) – the path of the lammps-settings file for the force field</p></li>
<li><p><strong>data_file</strong> (<em>str</em>) – the path of the lammps-data file for the force field</p></li>
<li><p><strong>path_ff_load</strong> (<em>str</em>) – the path of the file to load the force field parameters</p></li>
<li><p><strong>from</strong> (<em>optional</em><em>, </em><em>default=&quot;&quot;</em>) – </p></li>
<li><p><strong>param_balance</strong> (<em>numpy.ndarray</em>) – an array of integers representing the weights</p></li>
<li><p><strong>parameters</strong> (<em>of different types of</em>) – </p></li>
<li><p><strong>lat_gjf</strong> (<em>str</em>) – the path of the Gaussian input file</p></li>
<li><p><strong>crystal</strong> (<em>for the</em>) – </p></li>
<li><p><strong>Ulattice</strong> (<em>float</em>) – the lattice energy of the crystal</p></li>
<li><p><strong>Hartree</strong> (<em>in</em>) – </p></li>
<li><p><strong>pes_dirs</strong> (<em>list</em>) – a list of directories containing PES data (optional, default=[])</p></li>
<li><p><strong>dielectric_constant</strong> (<em>float</em>) – the dielectric constant of the solvent</p></li>
<li><p><strong>(</strong><strong>optional</strong> – </p></li>
<li><p><strong>default=3.0</strong><strong>)</strong> – </p></li>
<li><p><strong>ewald</strong> (<em>bool</em>) – whether or not to use Ewald summation</p></li>
<li><p><strong>electrostatics</strong> (<em>for</em>) – </p></li>
<li><p><strong>alpha_ewald</strong> (<em>float</em>) – the alpha parameter for Ewald summation (optional, default=0.5)</p></li>
<li><p><strong>nkmaxs</strong> (<em>numpy.ndarray</em>) – an array of integers representing the number of k vectors</p></li>
<li><p><strong>summation</strong> (<em>to use in Ewald</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a dictionary containing the information needed for the optimization,
including the following keys:
root (str): the directory where the optimization is run
name (str): the name of the optimization
idx (int): an integer index of the optimization
param_balance (numpy.ndarray): an array of integers
representing the weights of different types of parameters
reg (numpy.ndarray): an array of regularization
factors for different types of parameters
task_balance (numpy.ndarray): an array of integers
specifying the weights of each task
all_task_list (list): a list of dictionaries,</p>
<blockquote>
<div><dl class="simple">
<dt>each containing the following keys:</dt><dd><p>sys (parmed.Structure): the structure for the task
atomtypelabels (list): a list of strings
representing the atom types in the task
scale_structure (float): a scaling factor for the structure energy
scale_force (float): a scaling factor for the force
scale_energy (float): a scaling factor for the energy
type (str): a string representing the type of task
(‘opt’,’opt_lat’, and ‘pes’)</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>work (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.run">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pes_dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.run" title="Permalink to this definition"></a></dt>
<dd><p>This function is the main function for optimizing force fields.
It takes an initial force field, a work dictionary, an optimization algorithm,
and other optional arguments such as maximum iterations
and potential energy surface directories, and returns the optimized force field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff_ini</strong> – an initial force field</p></li>
<li><p><strong>work</strong> – a dictionary containing information about the system</p></li>
<li><p><strong>parameters</strong> (<em>and the optimization</em>) – </p></li>
<li><p><strong>algo</strong> – a string indicating the optimization algorithm to use (SDM, FDM, or BO)</p></li>
<li><p><strong>maxiter</strong> – an integer indicating the maximum number</p></li>
<li><p><strong>algorithm</strong> (<em>of iterations for the optimization</em>) – </p></li>
<li><p><strong>pes_dirs</strong> – a list of potential energy surface directories</p></li>
<li><p><strong>plotting</strong> (<em>for</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the optimized force field</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ff_opt</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.save_to_gjf_lmp">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">save_to_gjf_lmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#save_to_gjf_lmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.save_to_gjf_lmp" title="Permalink to this definition"></a></dt>
<dd><p>The function saves the optimized structures with the force field
in the following formats:
(1) monomer</p>
<blockquote>
<div><p>Gaussian Input File (xxx.gjf)
Lammps Input Files (xxx.data,xxx.in.settings)</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>crystal
Gaussian Input File (xxx.gjf)
Lammps Input Files (xxx.data,xxx.in.settings)
XYX File for OVITO, VESTA and so on.  (xxx.xyz)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> – a dictionary containing the force field parameters.</p></li>
<li><p><strong>work</strong> – a dictionary containing information about the optimization work.</p></li>
<li><p><strong>label</strong> – a string specifying a label for the output files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function does not explicitly return any value, but it saves the FF to the specified file formats.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.delff_lat.search_neighbors">
<span class="sig-prename descclassname"><span class="pre">delff.delff_lat.</span></span><span class="sig-name descname"><span class="pre">search_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/delff_lat.html#search_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.delff_lat.search_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-delff.energy">
<span id="delff-energy-module"></span><h2>delff.energy module<a class="headerlink" href="#module-delff.energy" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.energy.energy">
<span class="sig-prename descclassname"><span class="pre">delff.energy.</span></span><span class="sig-name descname"><span class="pre">energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/energy.html#energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.energy.energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total energy of a system given the force field, coordinates in rtp format, and force field assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>ewald</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses Ewald summation for long-range electrostatic interactions. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.energy.energy_coord">
<span class="sig-prename descclassname"><span class="pre">delff.energy.</span></span><span class="sig-name descname"><span class="pre">energy_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/energy.html#energy_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.energy.energy_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the total energy of a system given the force field, coordinates in cartesian format, and force field assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the coordinates in cartesian format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>ewald</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses Ewald summation for long-range electrostatic interactions. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total energy of the system in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.energy.energy_each">
<span class="sig-prename descclassname"><span class="pre">delff.energy.</span></span><span class="sig-name descname"><span class="pre">energy_each</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/energy.html#energy_each"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.energy.energy_each" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the energy contribution of each interaction type in a system given the force field, coordinates in rtp format, and force field assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>rtp_lat</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a><em>, </em><em>optional</em>) – RTPCoord object containing the coordinates in rtp format for the lattice sites of a periodic system. Defaults to None.</p></li>
<li><p><strong>ewald</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses Ewald summation for long-range electrostatic interactions. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the energy contribution of each interaction type (bonding, angle, dihedral, improper, Coulombic, long-range Coulombic, and van der Waals) in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.energy.energy_each_coord">
<span class="sig-prename descclassname"><span class="pre">delff.energy.</span></span><span class="sig-name descname"><span class="pre">energy_each_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/energy.html#energy_each_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.energy.energy_each_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the energy contribution of each interaction type in a system given the force field, coordinates in cartesian format, and force field assignments.
Define nonbonding type for a periodic tystem with ewald option
ewald=False: lj/charmm/coul/charmm
ewald=True : lj/charmm/coud/long with pair ewald option
ref: <a class="reference external" href="https://docs.lammps.org/pair_charmm.html">https://docs.lammps.org/pair_charmm.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the coordinates in cartesian format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>ewald</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses Ewald summation for long-range electrostatic interactions. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the energy contribution of each interaction type (bonding, angle, dihedral, improper, Coulombic, long-range Coulombic, and van der Waals) in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.evalfunc">
<span id="delff-evalfunc-module"></span><h2>delff.evalfunc module<a class="headerlink" href="#module-delff.evalfunc" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_Ulattice">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_Ulattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt_monomer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_Ulattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_Ulattice" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residual between the lattice energy calculated with the force field and the target lattice energy at the optimized structures with the <a href="#id1"><span class="problematic" id="id2">ff_</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_tgt_lat</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object for the lattice containing the coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>sys_tgt_monomer</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object for the monomer containing the coordinates in xyz format.</p></li>
<li><p><strong>U_lattice</strong> (<em>f64</em>) – Target lattice energy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The energy residual.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_Ulattice_tgt">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_Ulattice_tgt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt_monomer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_Ulattice_tgt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_Ulattice_tgt" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residual between the lattice energy calculated with the force field and the target lattice energy at the target lattice structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_tgt_lat</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object for the lattice containing the coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>sys_tgt_monomer</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object for the monomer containing the coordinates in xyz format.</p></li>
<li><p><strong>U_lattice</strong> (<em>f64</em>) – Target lattice energy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The energy residual.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_force">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_force" title="Permalink to this definition"></a></dt>
<dd><p>Computes the square of the norm of the gradient of the total energy with respect to the coordinates of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_tgt</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object containing the coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The square of the norm of the gradient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_pes">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_pes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_pes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_pes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_pes" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residual of the potential energy surface (PES) based on a Boltzmann-weighted square difference between reference and computed energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_pes</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the PES coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>energies</strong> (<em>Array</em>) – An array of reference energies for each structure in the PES.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The PES residual.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_sum">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_reg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_sum" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the sum of residuals for different types of tasks: optimization, optimization with lattice, and potential energy surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff_reg</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>work</strong> (<em>dict</em>) – A dictionary containing various task parameters and balances.</p></li>
<li><p><strong>algo</strong> (<em>str</em>) – The algorithm to be used, either ‘SDM’, ‘BO’, or ‘FDM’.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints additional information. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of residuals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_sys">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_sys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_sys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_sys" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residual between the system’s optimized and target RTP coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_tgt</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object containing the coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>reg</strong> (<em>Array</em>) – An array containing the regularization parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The residual.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.evalfunc.L_sys_lat">
<span class="sig-prename descclassname"><span class="pre">delff.evalfunc.</span></span><span class="sig-name descname"><span class="pre">L_sys_lat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_tgt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff_lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/evalfunc.html#L_sys_lat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.evalfunc.L_sys_lat" title="Permalink to this definition"></a></dt>
<dd><p>Computes the residuals between the system’s optimized and target lattice and coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys_tgt</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Target System object containing the coordinates in xyz format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>reg</strong> (<em>Array</em>) – An array containing the regularization parameters.</p></li>
<li><p><strong>coeff_lattice</strong> (<em>f64</em><em>, </em><em>optional</em>) – Coefficient for the lattice residual. Defaults to 10.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The combined residual of lattice and coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f64</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.gaussianff">
<span id="delff-gaussianff-module"></span><h2>delff.gaussianff module<a class="headerlink" href="#module-delff.gaussianff" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.gaussianff.get_ref_sys_and_energies">
<span class="sig-prename descclassname"><span class="pre">delff.gaussianff.</span></span><span class="sig-name descname"><span class="pre">get_ref_sys_and_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianff.html#get_ref_sys_and_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianff.get_ref_sys_and_energies" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the potential energy surface (PES)
for a set of molecular geometries obtained from multiple Gaussian log files.
The PES is generated by calculating the total energy for each of the geometries,
and then grouping them based on their energy proximity to the global minimum.
The function returns a list of PESs,
where each PES is represented by a list of two items: a System object containing the geometries,
and a NumPy array containing the corresponding energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname_list</strong> – A list of strings containing the directory paths to the Gaussian log files.</p></li>
<li><p><strong>natom</strong> – An integer representing the number of atoms in each molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of PESs, where each PES is represented by a list of two items:
a System object containing the geometries, and a NumPy array containing the corresponding energies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pes_list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.gaussianff.get_sys_from_gjf">
<span class="sig-prename descclassname"><span class="pre">delff.gaussianff.</span></span><span class="sig-name descname"><span class="pre">get_sys_from_gjf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gjffile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianff.html#get_sys_from_gjf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianff.get_sys_from_gjf" title="Permalink to this definition"></a></dt>
<dd><p>The function get_sys_from_gjf creates a System object from a Gaussian input file (gjffile)
containing atomic coordinates and lattice vectors.
It first creates an instance of a GaussianHandler class to read the coordinates
and lattice vectors from the input file, converts the coordinates to a NumPy array,
and uses these coordinates and lattice vectors to create a System object. The System object is then returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gjffile</strong> – A string containing the path and filename of the Gaussian input file</p></li>
<li><p><strong>vectors.</strong> (<em>from which to extract the coordinates and lattice</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns a System object containing the atomic coordinates and lattice vectors
extracted from the Gaussian input file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.gaussianff.get_sys_from_log">
<span class="sig-prename descclassname"><span class="pre">delff.gaussianff.</span></span><span class="sig-name descname"><span class="pre">get_sys_from_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianff.html#get_sys_from_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianff.get_sys_from_log" title="Permalink to this definition"></a></dt>
<dd><p>The function get_sys_from_log extracts the atomic coordinates from a Gaussian log file (logfile)
and creates a System object containing the coordinates.
It first creates an instance of a GaussianHandler class to read the coordinates from the log file,
converts the coordinates to a NumPy array, and uses these coordinates to create a System object.
The System object is then returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfile</strong> – A string containing the path and filename of the Gaussian log file from which to extract the coordinates.</p></li>
<li><p><strong>nmol</strong> – An integer representing the number of molecules in the system.</p></li>
<li><p><strong>natom</strong> – An integer representing the total number of atoms in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns a System object containing the atomic coordinates extracted from the Gaussian log file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.gaussianff.write_gjf">
<span class="sig-prename descclassname"><span class="pre">delff.gaussianff.</span></span><span class="sig-name descname"><span class="pre">write_gjf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gjffile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypelabels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianff.html#write_gjf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianff.write_gjf" title="Permalink to this definition"></a></dt>
<dd><p>The function write_gjf writes the necessary input data to a Gaussian job file (gjffile)
in the Gaussian input file format.
The file contains the system’s molecular geometry, charge, and atom type information in a format
that can be read by Gaussian software.
The function performs several checks to ensure the data is correctly formatted,
and it prints out the results for debugging purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gjffile</strong> – A string containing the path and filename for the Gaussian job file to be created.</p></li>
<li><p><strong>ff</strong> – An instance of a class containing force field information, including charges.</p></li>
<li><p><strong>sys</strong> – An instance of a class containing system information, including the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> – An instance of a class containing the force field information, including atom types.</p></li>
<li><p><strong>atomtypelabels</strong> – A list of strings containing the labels for each atom type in the force field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function does not return any values. It writes the input data to the specified Gaussian job file.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.gaussianhandler">
<span id="delff-gaussianhandler-module"></span><h2>delff.gaussianhandler module<a class="headerlink" href="#module-delff.gaussianhandler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="delff.gaussianhandler.GaussianHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.gaussianhandler.</span></span><span class="sig-name descname"><span class="pre">GaussianHandler</span></span><a class="reference internal" href="_modules/delff/gaussianhandler.html#GaussianHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianhandler.GaussianHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="delff.gaussianhandler.GaussianHandler.get_coord_log">
<span class="sig-name descname"><span class="pre">get_coord_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianhandler.html#GaussianHandler.get_coord_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianhandler.GaussianHandler.get_coord_log" title="Permalink to this definition"></a></dt>
<dd><p>This function reads the log file generated by Gaussian 16
and extracts the atomic coordinates of a molecule from it.
:param logfile: A string containing the name of the log file to be read.
:param nmol: An integer specifying the number of molecules in the system.
:param natom: An integer specifying the number of atoms in each molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A NumPy array of shape (nmol, natom, 3)</dt><dd><p>containing the Cartesian coordinates of all the atoms in the system.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>coord</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delff.gaussianhandler.GaussianHandler.get_info">
<span class="sig-name descname"><span class="pre">get_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianhandler.html#GaussianHandler.get_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianhandler.GaussianHandler.get_info" title="Permalink to this definition"></a></dt>
<dd><p>The function get_info reads a specified logfile line by line,
looks for a line containing the string “SCF Done:”,
extracts the numerical value of the total energy from that line,
and returns a dictionary with the key ‘total_energy’ and the extracted value as its value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – This argument refers to the instance of the class that this function belongs to.</p></li>
<li><p><strong>logfile</strong> – A string containing the path to the log file to be read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns a dictionary with the key ‘total_energy’
and the value of the total energy extracted from the log file.
The dictionary is stored as an attribute logdict of the instance self.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delff.gaussianhandler.GaussianHandler.get_system">
<span class="sig-name descname"><span class="pre">get_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gjffile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/gaussianhandler.html#GaussianHandler.get_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.gaussianhandler.GaussianHandler.get_system" title="Permalink to this definition"></a></dt>
<dd><p>This function reads a Gaussian input file (.gjf) and extracts the molecular system information
including the coordinates, lattice vectors (if any), and elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – the instance of the class containing the function.</p></li>
<li><p><strong>gjffile</strong> – a string representing the path to the Gaussian input file (.gjf) to be read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a 3D numpy array of shape (nmol, natom, 3),</dt><dd><p>representing the coordinates of the atoms in the molecular system.</p>
</dd>
<dt>lattice: a 2D numpy array of shape (3,3) or None, i</dt><dd><p>representing the lattice vectors of the system.
If there is no lattice vector information, it is set to None.</p>
</dd>
</dl>
<p>elements: a list of strings, representing the elements of the atoms in the molecular system.
nmol: an integer, representing the number of molecules in the system.
natom: an integer, representing the number of atoms in each molecule.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coord</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-delff.lammpsff">
<span id="delff-lammpsff-module"></span><h2>delff.lammpsff module<a class="headerlink" href="#module-delff.lammpsff" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.generate_scale_mat">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">generate_scale_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#generate_scale_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.generate_scale_mat" title="Permalink to this definition"></a></dt>
<dd><p>Generates matrices that represent scaled bonding connections between atoms in a molecular system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonds</strong> (<em>ndarray</em>) – Array of bonds where each bond is represented by a pair of atom indices.</p></li>
<li><p><strong>natoms</strong> (<em>int</em>) – Total number of atoms in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple of matrices that represent scaled bonding connections.</dt><dd><p>The first matrix contains bonding connections of distance 1 and 2.
The second matrix contains bonding connections of distance 3.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.make_atomtypelabels">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">make_atomtypelabels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomtypelabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#make_atomtypelabels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.make_atomtypelabels" title="Permalink to this definition"></a></dt>
<dd><p>Generates atom type labels based on atom type sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomtypelabels</strong> (<em>list</em>) – List of initial atom type labels.</p></li>
<li><p><strong>atomtypes</strong> (<em>jax.numpy.ndarray</em>) – Array of atom types.</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em>) – List of atom type sets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated list of atom type labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.make_nbcharges">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">make_nbcharges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#make_nbcharges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.make_nbcharges" title="Permalink to this definition"></a></dt>
<dd><p>Generates charges based on atom type sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>charges</strong> (<em>jax.numpy.ndarray</em>) – Array of charges.</p></li>
<li><p><strong>atomtypes</strong> (<em>jax.numpy.ndarray</em>) – Array of atom types.</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em>) – List of atom type sets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of non-bonded charges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.make_nbmasses">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">make_nbmasses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#make_nbmasses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.make_nbmasses" title="Permalink to this definition"></a></dt>
<dd><p>Generates masses based on atom type sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masses</strong> (<em>jax.numpy.ndarray</em>) – Array of atom masses.</p></li>
<li><p><strong>atomtypes</strong> (<em>jax.numpy.ndarray</em>) – Array of atom types.</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em>) – List of atom type sets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of non-bonded masses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.make_nbpairs">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">make_nbpairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#make_nbpairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.make_nbpairs" title="Permalink to this definition"></a></dt>
<dd><p>Generates non-bonded pairs based on atom type sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>jax.numpy.ndarray</em>) – Array of pair coefficients.</p></li>
<li><p><strong>atomtypes</strong> (<em>jax.numpy.ndarray</em>) – Array of atom types.</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em>) – List of atom type sets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of non-bonded pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.read_system">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">read_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_settings_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypesets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#read_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.read_system" title="Permalink to this definition"></a></dt>
<dd><p>Reads system data from the settings and data files in the LAMMPS format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_settings_file</strong> (<em>str</em>) – Path to the settings file.</p></li>
<li><p><strong>data_file</strong> (<em>str</em>) – Path to the data file.</p></li>
<li><p><strong>atomtypesets</strong> (<em>list</em><em>, </em><em>optional</em>) – List of atom type sets. If None, it will be created in the function. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p><a href="#id3"><span class="problematic" id="id4">ff_</span></a> (ForceField): Updated ForceField object.</p></li>
<li><p><a href="#id5"><span class="problematic" id="id6">sys_</span></a> (System): System object containing the molecular system data.</p></li>
<li><p><a href="#id7"><span class="problematic" id="id8">ffa_</span></a> (ForceFieldAssignments): Updated ForceFieldAssignments object.</p></li>
<li><p>atomtypelabels (list): List of atom type labels.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.read_system_data">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">read_system_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralmasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralphis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmolvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natomvec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#read_system_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.read_system_data" title="Permalink to this definition"></a></dt>
<dd><p>Reads system data from the given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_file</strong> (<em>str</em>) – Path to the data file.</p></li>
<li><p><strong>dihedralmasks</strong> (<em>jax.numpy.ndarray</em>) – Array of dihedral masks.</p></li>
<li><p><strong>dihedralphis</strong> (<em>jax.numpy.ndarray</em>) – Array of dihedral angles.</p></li>
<li><p><strong>content.</strong> (<em>nmolvec</em><em> (</em><em>jax due to similar</em>) – </p></li>
<li><p><strong>Returns</strong> – tuple: A tuple containing <a href="#id9"><span class="problematic" id="id10">ff_</span></a> (ForceField), <a href="#id11"><span class="problematic" id="id12">sys_</span></a> (System), <a href="#id13"><span class="problematic" id="id14">ffa_</span></a> (ForceFieldAssignments), and atomtypelabels (List of str). These objects contain the information for the system, the force field, the force field assignments for each atom, and the atom type labels, respectively.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.read_system_in_settings">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">read_system_in_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_settings_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#read_system_in_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.read_system_in_settings" title="Permalink to this definition"></a></dt>
<dd><p>Reads a system settings file in the LAMMPS format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_settings_file</strong> (<em>str</em>) – Path to the settings file.</p></li>
<li><p><strong>charges</strong> (<em>jax.numpy.ndarray</em><em>, </em><em>optional</em>) – Array containing charges. If None, no charges will be assigned. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p><a href="#id15"><span class="problematic" id="id16">ff_</span></a> (ForceField): ForceField object containing the force field parameters.</p></li>
<li><p>dihedralmasks (jax.numpy.ndarray): Array of dihedral masks.</p></li>
<li><p>dihedralphis (jax.numpy.ndarray): Array of dihedral angles.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.write_system_data">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">write_system_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtypelabels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#write_system_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.write_system_data" title="Permalink to this definition"></a></dt>
<dd><p>Writes the system data including atom types, bond types, coordinates, masses and force field assignments into a LAMMPS data file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_file</strong> (<em>str</em>) – Name of the output data file.</p></li>
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the information for the system.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>atomtypelabels</strong> (<em>List</em><em> of </em><em>str</em>) – List of atom type labels.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.lammpsff.write_system_in_settings">
<span class="sig-prename descclassname"><span class="pre">delff.lammpsff.</span></span><span class="sig-name descname"><span class="pre">write_system_in_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_settings_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/lammpsff.html#write_system_in_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.lammpsff.write_system_in_settings" title="Permalink to this definition"></a></dt>
<dd><p>Writes the system settings, including force field parameters and coefficients, into a LAMMPS in_settings file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_settings_file</strong> (<em>str</em>) – Name of the output settings file.</p></li>
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>charges</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – If given, includes charge information. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.metaopt">
<span id="delff-metaopt-module"></span><h2>delff.metaopt module<a class="headerlink" href="#module-delff.metaopt" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.metaopt.doreg_and_mask_bounds">
<span class="sig-prename descclassname"><span class="pre">delff.metaopt.</span></span><span class="sig-name descname"><span class="pre">doreg_and_mask_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/metaopt.html#doreg_and_mask_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.metaopt.doreg_and_mask_bounds" title="Permalink to this definition"></a></dt>
<dd><p>This function takes a force field object, a dictionary of work, an array of full bounds,
and an array of mask as input. It generates a new array of bounds
by dividing each element of the full bounds array by the corresponding element of the reg array,
which is extracted from the work dictionary.
It then filters the bounds array using the mask array, and returns the resulting bounds array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff_ini</strong> – a ForceField object.</p></li>
<li><p><strong>work</strong> – a dictionary of work.</p></li>
<li><p><strong>bounds_full</strong> – an array of full bounds.</p></li>
<li><p><strong>mask</strong> – an array of mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a filtered array of bounds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bounds_reg</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.metaopt.metaopt">
<span class="sig-prename descclassname"><span class="pre">delff.metaopt.</span></span><span class="sig-name descname"><span class="pre">metaopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SDM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/metaopt.html#metaopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.metaopt.metaopt" title="Permalink to this definition"></a></dt>
<dd><p>This functioon optimized a force field using a given work specification.
The meta-optimization process optimizes the parameters of the force field
with respect to multiple tasks and multiple force field types.
The function uses the scipy.minimize method with the SLSQP algorithm to optimize the force field parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>type</strong> (<em>learning_rate</em>) – ForceField): The initial force field.</p></li>
<li><p><strong>(</strong><strong>type</strong> – dict): A dictionary that contains various parameters that define the optimization task.</p></li>
<li><p><strong>(</strong><strong>type</strong> – i32, optional): The maximum number of iterations for the optimization. Defaults to 100.</p></li>
<li><p><strong>(</strong><strong>type</strong> – str, optional): The optimization algorithm to use. Defaults to ‘SDM’.</p></li>
<li><p><strong>(</strong><strong>type</strong> – float, optional): The learning rate for the optimization. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ForceField).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The metaopt function return the optimezed force field (type</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.metaopt.set_bounds">
<span class="sig-prename descclassname"><span class="pre">delff.metaopt.</span></span><span class="sig-name descname"><span class="pre">set_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/metaopt.html#set_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.metaopt.set_bounds" title="Permalink to this definition"></a></dt>
<dd><p>This function defines a function set_bounds() which sets bounds on force field parameters based on given inputs.
:param ff_ini: The initial force field object.
:type ff_ini: ForceField
:param work: A dictionary containing additional information about the force field.
:type work: dict
:param mask: A Boolean array indicating whether to apply bounds on a given force field parameter.
:type mask: Array</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dictionary containg boundary values of each force field parameters.
ff_ini (ForceField): The modified iniital force field object.</p>
<blockquote>
<div><p>The paramters for pairs (vdw-parameters) are adaptively modifled for avoiding errors.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bounds (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.metaopt.set_mask">
<span class="sig-prename descclassname"><span class="pre">delff.metaopt.</span></span><span class="sig-name descname"><span class="pre">set_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_ini</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">work</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/metaopt.html#set_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.metaopt.set_mask" title="Permalink to this definition"></a></dt>
<dd><p>This function generates a mask array based on the input force field and the given work type.
The generated mask array is used to zero-out certain force field parameters during optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff_ini</strong> – An instance of the ForceField class representing the initial force field.</p></li>
<li><p><strong>(</strong><strong>type</strong> (<em>work</em>) – dict): A dictionary that contains various parameters that define the optimization task.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array of integers representing the mask for the force field parameters.
The elements of the array are either 0 or 1, indicating whether or not the corresponding parameter
should be regularized.
chg_mask: A 1D numpy array of integers representing the mask for the atomic charges in the force field.
This mask is generated in the same way as the mask array, but only includes the mask for the charge parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mask</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.nonbonding_energy">
<span id="delff-nonbonding-energy-module"></span><h2>delff.nonbonding_energy module<a class="headerlink" href="#module-delff.nonbonding_energy" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.calc_coulomb">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">calc_coulomb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_constant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccoeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#calc_coulomb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.calc_coulomb" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the Coulomb interaction between two atom types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – Interatomic distance.</p></li>
<li><p><strong>atomtype0</strong> (<em>int</em>) – Atom type index of the first atom.</p></li>
<li><p><strong>atomtype1</strong> (<em>int</em>) – Atom type index of the second atom.</p></li>
<li><p><strong>charges</strong> (<em>array</em>) – Array containing the charges of the atoms.</p></li>
<li><p><strong>dielectric_constant</strong> (<em>float</em>) – Dielectric constant of the system.</p></li>
<li><p><strong>ccoeff</strong> (<em>float</em>) – Coulomb coefficient.</p></li>
<li><p><strong>ccutoff</strong> (<em>float</em>) – Coulomb interaction cutoff distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Coulomb interaction energy in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.calc_vdw">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">calc_vdw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcoeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#calc_vdw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.calc_vdw" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the van der Waals interaction between two atom types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – Interatomic distance.</p></li>
<li><p><strong>atomtype0</strong> (<em>int</em>) – Atom type index of the first atom.</p></li>
<li><p><strong>atomtype1</strong> (<em>int</em>) – Atom type index of the second atom.</p></li>
<li><p><strong>pairs</strong> (<em>array</em>) – Array containing the epsilon and sigma parameters for the atoms.</p></li>
<li><p><strong>vcoeff</strong> (<em>float</em>) – van der Waals coefficient.</p></li>
<li><p><strong>vcutoff</strong> (<em>float</em>) – van der Waals interaction cutoff distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>van der Waals interaction energy in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.charmm_Sfactor">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">charmm_Sfactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#charmm_Sfactor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.charmm_Sfactor" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the CHARMM switching function value for a given distance and cutoff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – Interatomic distance.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Interaction cutoff distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the CHARMM switching function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.nonbond_energy">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#nonbond_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.nonbond_energy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the nonbonded energy of a system after correcting for intramolecular interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total Coulomb energy and total van der Waals energy after corrections in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.nonbond_energy_allpairs">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_allpairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#nonbond_energy_allpairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.nonbond_energy_allpairs" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the nonbonded energy of all atom pairs in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total Coulomb energy and total van der Waals energy of all atom pairs in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy.nonbond_energy_intramol_correction">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_intramol_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy.html#nonbond_energy_intramol_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy.nonbond_energy_intramol_correction" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the nonbonded energy of a system after correcting for intramolecular interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total Coulomb energy and total van der Waals energy after intramolecular corrections in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.nonbonding_energy_ewald">
<span id="delff-nonbonding-energy-ewald-module"></span><h2>delff.nonbonding_energy_ewald module<a class="headerlink" href="#module-delff.nonbonding_energy_ewald" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_ewald.calc_coulomb_long_all">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_ewald.</span></span><span class="sig-name descname"><span class="pre">calc_coulomb_long_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy_ewald.html#calc_coulomb_long_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_ewald.calc_coulomb_long_all" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the long-range Coulomb energy of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the lattice and coordinates of the system.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Long-range Coulomb energy of the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_ewald.calc_coulomb_self">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_ewald.</span></span><span class="sig-name descname"><span class="pre">calc_coulomb_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy_ewald.html#calc_coulomb_self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_ewald.calc_coulomb_self" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the self-interaction part of the Coulomb energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the lattice and coordinates of the system.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Self-interaction part of the Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_ewald.calc_coulomb_short">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_ewald.</span></span><span class="sig-name descname"><span class="pre">calc_coulomb_short</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomtype1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_constant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccoeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/nonbonding_energy_ewald.html#calc_coulomb_short"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_ewald.calc_coulomb_short" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the short-range Coulomb energy between two atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – Distance between two atoms.</p></li>
<li><p><strong>atomtype0</strong> (<em>int</em>) – Atom type of the first atom.</p></li>
<li><p><strong>atomtype1</strong> (<em>int</em>) – Atom type of the second atom.</p></li>
<li><p><strong>charges</strong> (<em>array</em>) – Array containing the charges of each atom type.</p></li>
<li><p><strong>dielectric_constant</strong> (<em>float</em>) – The constant representing the dielectric properties of the medium.</p></li>
<li><p><strong>ccoeff</strong> (<em>float</em>) – The coefficient for the short-range part of the interaction.</p></li>
<li><p><strong>ccutoff</strong> (<em>float</em>) – The cutoff distance for the short-range part of the interaction.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The Ewald summation parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Short-range Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_ewald.nonbond_energy_ewald">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_ewald.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_ewald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy_ewald.html#nonbond_energy_ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_ewald.nonbond_energy_ewald" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the non-bonded energy of a system using Ewald summation.</p>
<p>The function first computes the non-bonded energy without intra-molecular correction,
then it calculates the intra-molecular correction and subtracts it from the total non-bonded energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the system coordinates in rtp format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>rtp_lat</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the lattice coordinates in rtp format.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the information for the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The non-bonded energy of the system using Ewald summation in Ha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_ewald.nonbond_energy_ewald_wo_intramol_correction">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_ewald.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_ewald_wo_intramol_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy_ewald.html#nonbond_energy_ewald_wo_intramol_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_ewald.nonbond_energy_ewald_wo_intramol_correction" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the non-bonded energy of the system using Ewald summation, without intramolecular correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in RTP format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the lattice and coordinates of the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Non-bonded energy of the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.nonbonding_energy_neighbors">
<span id="delff-nonbonding-energy-neighbors-module"></span><h2>delff.nonbonding_energy_neighbors module<a class="headerlink" href="#module-delff.nonbonding_energy_neighbors" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_neighbors.nonbond_energy_allneighbors">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_neighbors.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_allneighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy_neighbors.html#nonbond_energy_allneighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_neighbors.nonbond_energy_allneighbors" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the non-bonded energy of all neighbor interactions in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in RTP format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the Coulomb and van der Waals energies of all neighbor interactions in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.nonbonding_energy_neighbors.nonbond_energy_neighbors">
<span class="sig-prename descclassname"><span class="pre">delff.nonbonding_energy_neighbors.</span></span><span class="sig-name descname"><span class="pre">nonbond_energy_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtp_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float64</span></span></span><a class="reference internal" href="_modules/delff/nonbonding_energy_neighbors.html#nonbond_energy_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.nonbonding_energy_neighbors.nonbond_energy_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the non-bonded energy between neighboring atoms, taking into account both external and internal interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>rtp</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the coordinates in RTP format.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom in the system.</p></li>
<li><p><strong>rtp_lat</strong> (<a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><em>RTPCoord</em></a>) – RTPCoord object containing the lattice coordinates in RTP format.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the Coulomb and van der Waals energies of the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.objects">
<span id="delff-objects-module"></span><h2>delff.objects module<a class="headerlink" href="#module-delff.objects" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="delff.objects.ForceField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">ForceField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bondtypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angletypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impropertypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vscale3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cscale3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/objects.html#ForceField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.ForceField" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the parameters for a molecular force field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bondtypes</strong> (<em>Array</em><em>, </em><em>optional</em>) – Bond parameters of the force field. Default is None.</p></li>
<li><p><strong>angletypes</strong> (<em>Array</em><em>, </em><em>optional</em>) – Angle parameters of the force field. Default is None.</p></li>
<li><p><strong>dihedralks</strong> (<em>Array</em><em>, </em><em>optional</em>) – Dihedral parameters of the force field. Default is None.</p></li>
<li><p><strong>impropertypes</strong> (<em>Array</em><em>, </em><em>optional</em>) – Improper dihedral parameters of the force field. Default is None.</p></li>
<li><p><strong>pairs</strong> (<em>Array</em><em>, </em><em>optional</em>) – Nonbonded interaction parameters of the force field. Default is None.</p></li>
<li><p><strong>charges</strong> (<em>Array</em><em>, </em><em>optional</em>) – Atomic charges for the force field. Default is None.</p></li>
<li><p><strong>dielectric_constant</strong> (<em>Array</em><em>, </em><em>optional</em>) – Dielectric constant for the force field. Default is 3.0.</p></li>
<li><p><strong>vscale3</strong> (<em>f64</em><em>, </em><em>optional</em>) – Scaling factor for 1-3 van der Waals interactions. Default is 1.0.</p></li>
<li><p><strong>cscale3</strong> (<em>f64</em><em>, </em><em>optional</em>) – Scaling factor for 1-3 Coulomb interactions. Default is 1.0.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.angletypes">
<span class="sig-name descname"><span class="pre">angletypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.angletypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.bondtypes">
<span class="sig-name descname"><span class="pre">bondtypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.bondtypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.charges">
<span class="sig-name descname"><span class="pre">charges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.charges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.cscale3">
<span class="sig-name descname"><span class="pre">cscale3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#delff.objects.ForceField.cscale3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.dielectric_constant">
<span class="sig-name descname"><span class="pre">dielectric_constant</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#delff.objects.ForceField.dielectric_constant" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.dihedralks">
<span class="sig-name descname"><span class="pre">dihedralks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.dihedralks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.impropertypes">
<span class="sig-name descname"><span class="pre">impropertypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.impropertypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.pairs">
<span class="sig-name descname"><span class="pre">pairs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceField.pairs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceField.vscale3">
<span class="sig-name descname"><span class="pre">vscale3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#delff.objects.ForceField.vscale3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">ForceFieldAssignments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomtypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralmasks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralphis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impropers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjmat012</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjmat3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmolvec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natomvec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermol_dists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbatomtypesets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latidx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkvecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkmaxs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_ewald</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/objects.html#ForceFieldAssignments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.ForceFieldAssignments" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains the assignment of force field parameters for each atom in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomtypes</strong> (<em>Array</em><em>, </em><em>optional</em>) – Atom type indices for each atom in the system. Default is None.</p></li>
<li><p><strong>masses</strong> (<em>Array</em><em>, </em><em>optional</em>) – Atomic masses for each atom in the system. Default is None.</p></li>
<li><p><strong>bonds</strong> (<em>Array</em><em>, </em><em>optional</em>) – Bond parameters for each atom in the system. Default is None.</p></li>
<li><p><strong>angles</strong> (<em>Array</em><em>, </em><em>optional</em>) – Angle parameters for each atom in the system. Default is None.</p></li>
<li><p><strong>dihedrals</strong> (<em>Array</em><em>, </em><em>optional</em>) – Dihedral parameters for each atom in the system. Default is None.</p></li>
<li><p><strong>dihedralmasks</strong> (<em>Array</em><em>, </em><em>optional</em>) – Masks for applying dihedral parameters. Default is None.</p></li>
<li><p><strong>dihedralphis</strong> (<em>Array</em><em>, </em><em>optional</em>) – Phi angles for dihedrals. Default is None.</p></li>
<li><p><strong>impropers</strong> (<em>Array</em><em>, </em><em>optional</em>) – Improper dihedral parameters for each atom in the system. Default is None.</p></li>
<li><p><strong>adjmat012</strong> (<em>Array</em><em>, </em><em>optional</em>) – Adjacency matrix for the topological distances of zero to two. Default is None. The zero distance indicates the same atom.</p></li>
<li><p><strong>adjmat3</strong> (<em>Array</em><em>, </em><em>optional</em>) – Adjacency matrix for the topological distance of three. Default is None.</p></li>
<li><p><strong>nmolvec</strong> (<em>Array</em><em>, </em><em>optional</em>) – Vector containing the number of molecules in the system. Default is None.</p></li>
<li><p><strong>natomvec</strong> (<em>Array</em><em>, </em><em>optional</em>) – Vector containing the number of atoms in each molecule. Default is None.</p></li>
<li><p><strong>intermol_dists</strong> (<em>Array</em><em>, </em><em>optional</em>) – Inter-molecular distances. Default is None.</p></li>
<li><p><strong>nbatomtypesets</strong> (<em>list</em><em>, </em><em>optional</em>) – List of non-bonded atom type sets. Default is None.</p></li>
<li><p><strong>neighbors</strong> (<em>Array</em><em>, </em><em>optional</em>) – Matrix containing the neighbors for each atom. Default is None.</p></li>
<li><p><strong>latidx</strong> (<em>Array</em><em>, </em><em>optional</em>) – Matrix containing the lattice indices for each atom. Default is None.</p></li>
<li><p><strong>nkvecs</strong> (<em>Array</em><em>, </em><em>optional</em>) – Matrix containing the k vectors for Ewald summation. Default is None.</p></li>
<li><p><strong>nkmaxs</strong> (<em>Array</em><em>, </em><em>optional</em>) – Maximum k values for each direction. Default is None.</p></li>
<li><p><strong>alpha_ewald</strong> (<em>f64</em><em>, </em><em>optional</em>) – Alpha parameter for Ewald summation. Default is None.</p></li>
<li><p><strong>sigma_ewald</strong> (<em>f64</em><em>, </em><em>optional</em>) – Sigma parameter for Ewald summation. Default is None.</p></li>
<li><p><strong>vcutoff</strong> (<em>i32</em><em>, </em><em>optional</em>) – Cut-off radius for van der Waals interactions. Default is 10.</p></li>
<li><p><strong>ccutoff</strong> (<em>i32</em><em>, </em><em>optional</em>) – Cut-off radius for Coulomb interactions. Default is 10.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.adjmat012">
<span class="sig-name descname"><span class="pre">adjmat012</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.adjmat012" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.adjmat3">
<span class="sig-name descname"><span class="pre">adjmat3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.adjmat3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.alpha_ewald">
<span class="sig-name descname"><span class="pre">alpha_ewald</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.alpha_ewald" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.angles">
<span class="sig-name descname"><span class="pre">angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.angles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.atomtypes">
<span class="sig-name descname"><span class="pre">atomtypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.atomtypes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.bonds">
<span class="sig-name descname"><span class="pre">bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.bonds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.ccutoff">
<span class="sig-name descname"><span class="pre">ccutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int32</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.ccutoff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.dihedralmasks">
<span class="sig-name descname"><span class="pre">dihedralmasks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.dihedralmasks" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.dihedralphis">
<span class="sig-name descname"><span class="pre">dihedralphis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.dihedralphis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.dihedrals">
<span class="sig-name descname"><span class="pre">dihedrals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.dihedrals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.impropers">
<span class="sig-name descname"><span class="pre">impropers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.impropers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.intermol_dists">
<span class="sig-name descname"><span class="pre">intermol_dists</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.intermol_dists" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.latidx">
<span class="sig-name descname"><span class="pre">latidx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.latidx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.masses">
<span class="sig-name descname"><span class="pre">masses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.masses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.natomvec">
<span class="sig-name descname"><span class="pre">natomvec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.natomvec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.nbatomtypesets">
<span class="sig-name descname"><span class="pre">nbatomtypesets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.nbatomtypesets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.neighbors">
<span class="sig-name descname"><span class="pre">neighbors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.nkmaxs">
<span class="sig-name descname"><span class="pre">nkmaxs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.nkmaxs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.nkvecs">
<span class="sig-name descname"><span class="pre">nkvecs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.nkvecs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.nmolvec">
<span class="sig-name descname"><span class="pre">nmolvec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.nmolvec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.sigma_ewald">
<span class="sig-name descname"><span class="pre">sigma_ewald</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float64</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.sigma_ewald" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.ForceFieldAssignments.vcutoff">
<span class="sig-name descname"><span class="pre">vcutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int32</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#delff.objects.ForceFieldAssignments.vcutoff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delff.objects.RTPCoord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">RTPCoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phiis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rall</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/objects.html#RTPCoord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.RTPCoord" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the internal coordinates of a molecule in terms of bond lengths, angles, and torsions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rs</strong> (<em>Array</em><em>, </em><em>optional</em>) – Bond lengths for each bond in the system. Default is None.</p></li>
<li><p><strong>thetas</strong> (<em>Array</em><em>, </em><em>optional</em>) – Bond angles for each angle in the system. Default is None.</p></li>
<li><p><strong>phids</strong> (<em>Array</em><em>, </em><em>optional</em>) – Dihedral angles for each dihedral in the system. Default is None.</p></li>
<li><p><strong>phiis</strong> (<em>Array</em><em>, </em><em>optional</em>) – Improper dihedral angles for each improper in the system. Default is None.</p></li>
<li><p><strong>rall</strong> (<em>Array</em><em>, </em><em>optional</em>) – Distances between all atom pairs in the system. Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.RTPCoord.phids">
<span class="sig-name descname"><span class="pre">phids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.RTPCoord.phids" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.RTPCoord.phiis">
<span class="sig-name descname"><span class="pre">phiis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.RTPCoord.phiis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.RTPCoord.rall">
<span class="sig-name descname"><span class="pre">rall</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.RTPCoord.rall" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.RTPCoord.rs">
<span class="sig-name descname"><span class="pre">rs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.RTPCoord.rs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.RTPCoord.thetas">
<span class="sig-name descname"><span class="pre">thetas</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.RTPCoord.thetas" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delff.objects.System">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/objects.html#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.System" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the system of interest, including atomic coordinates and lattice parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord</strong> (<em>Array</em><em>, </em><em>optional</em>) – Atomic coordinates in the system. Default is None.</p></li>
<li><p><strong>lattice</strong> (<em>Array</em><em>, </em><em>optional</em>) – Lattice parameters for periodic systems. Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.System.coord">
<span class="sig-name descname"><span class="pre">coord</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.System.coord" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.System.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.System.lattice" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delff.objects.Task">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">Task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ltype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'structures'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/objects.html#Task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.Task" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a computational task to perform on a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ltype</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of task to perform. Default is ‘structures’.</p></li>
<li><p><strong>params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters required for the task. Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.Task.Ltype">
<span class="sig-name descname"><span class="pre">Ltype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'structures'</span></em><a class="headerlink" href="#delff.objects.Task.Ltype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="delff.objects.Task.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#delff.objects.Task.params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.objects.update">
<span class="sig-prename descclassname"><span class="pre">delff.objects.</span></span><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></span><a class="reference internal" href="_modules/delff/objects.html#update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.objects.update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-delff.opt">
<span id="delff-opt-module"></span><h2>delff.opt module<a class="headerlink" href="#module-delff.opt" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.opt.ilu">
<span class="sig-prename descclassname"><span class="pre">delff.opt.</span></span><span class="sig-name descname"><span class="pre">ilu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/opt.html#ilu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt.ilu" title="Permalink to this definition"></a></dt>
<dd><p>This function performs an incomplete LU decomposition on a given matrix,
which factorizes the matrix into a lower triangular matrix
and an upper triangular matrix with the same diagonal as the original matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mat</strong> (<em>-</em>) – a 2D array representing the matrix to be decomposed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a lower triangular matrix with the same diagonal as mat.
- U: an upper triangular matrix with the same diagonal as mat.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>L</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.opt.opt_sys_jaxopt">
<span class="sig-prename descclassname"><span class="pre">delff.opt.</span></span><span class="sig-name descname"><span class="pre">opt_sys_jaxopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/opt.html#opt_sys_jaxopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt.opt_sys_jaxopt" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for optimizing the energy of a system
using JAXOpt library for gradient descent optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<em>-</em>) – a function that describes the force field of the physical system.</p></li>
<li><p><strong>sys_int</strong> (<em>-</em>) – an initial state of the physical system,
which contains information about the positions and momenta of its particles.</p></li>
<li><p><strong>ffa</strong> (<em>-</em>) – a set of additional parameters needed
for calculating the energy of the physical system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the optimized state of the physical system,</dt><dd><p>which minimizes its energy.</p>
</dd>
</dl>
<ul class="simple">
<li><p>info: information about the optimization process,
such as the number of iterations and the final value of the energy.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>sys_opt</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.opt.opt_sys_jvp">
<span class="sig-prename descclassname"><span class="pre">delff.opt.</span></span><span class="sig-name descname"><span class="pre">opt_sys_jvp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tangents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/opt.html#opt_sys_jvp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt.opt_sys_jvp" title="Permalink to this definition"></a></dt>
<dd><p>This function is the JVP rule for the optimization
of the lattice system of a molecular simulation.
It calculates the Jacobian-vector product (JVP)
of the function opt_lat_sys_jaxopt using implicit differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primals</strong> (<em>-</em>) – a tuple of three inputs: <a href="#id17"><span class="problematic" id="id18">ff_</span></a> (force field parameters),</p></li>
<li><p><strong>configuration</strong> (<em>sys_int</em><em> (</em><em>an instance</em><em> of </em><em>the System class that contains the initial</em>) – </p></li>
<li><p><strong>system</strong><strong>)</strong> (<em>of the molecular</em>) – </p></li>
<li><p><strong>ffa</strong> (<em>and</em>) – </p></li>
<li><p><strong>tangents</strong> (<em>-</em>) – a tuple of three tangents that correspond to the derivatives</p></li>
<li><p><strong>ff</strong> (<em>of</em>) – </p></li>
<li><p><strong>sys_int</strong> – </p></li>
<li><p><strong>ffa</strong> – </p></li>
<li><p><strong>respectively.</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>an instance of the System class that contains the optimized
configuration of the molecular system.</p>
<ul class="simple">
<li><p>tangents_out: a tuple of three tangents that correspond to the derivatives</p></li>
</ul>
<p>of <a href="#id19"><span class="problematic" id="id20">ff_</span></a>, sys_int, and <a href="#id21"><span class="problematic" id="id22">ffa_</span></a> with respect to the optimized configuration
of the molecular system.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>primals_out</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.opt_lat">
<span id="delff-opt-lat-module"></span><h2>delff.opt_lat module<a class="headerlink" href="#module-delff.opt_lat" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.opt_lat.ilu">
<span class="sig-prename descclassname"><span class="pre">delff.opt_lat.</span></span><span class="sig-name descname"><span class="pre">ilu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/opt_lat.html#ilu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt_lat.ilu" title="Permalink to this definition"></a></dt>
<dd><p>This function performs an incomplete LU decomposition on a given matrix,
which factorizes the matrix into a lower triangular matrix
and an upper triangular matrix with the same diagonal as the original matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mat</strong> (<em>-</em>) – a 2D array representing the matrix to be decomposed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a lower triangular matrix with the same diagonal as mat.
- U: an upper triangular matrix with the same diagonal as mat.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>L</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.opt_lat.opt_lat_sys_jaxopt">
<span class="sig-prename descclassname"><span class="pre">delff.opt_lat.</span></span><span class="sig-name descname"><span class="pre">opt_lat_sys_jaxopt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/opt_lat.html#opt_lat_sys_jaxopt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt_lat.opt_lat_sys_jaxopt" title="Permalink to this definition"></a></dt>
<dd><p>This function is used for optimizing the energy of a system
using JAXOpt library for gradient descent optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<em>-</em>) – a function that describes the force field of the physical system.</p></li>
<li><p><strong>sys_int</strong> (<em>-</em>) – an initial state of the physical system,
which contains information about the positions and momenta of its particles.</p></li>
<li><p><strong>ffa</strong> (<em>-</em>) – a set of additional parameters needed
for calculating the energy of the physical system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the optimized state of the physical system,</dt><dd><p>which minimizes its energy.</p>
</dd>
</dl>
<ul class="simple">
<li><p>info: information about the optimization process,
such as the number of iterations and the final value of the energy.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>sys_opt</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.opt_lat.opt_lat_sys_jvp">
<span class="sig-prename descclassname"><span class="pre">delff.opt_lat.</span></span><span class="sig-name descname"><span class="pre">opt_lat_sys_jvp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tangents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/opt_lat.html#opt_lat_sys_jvp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.opt_lat.opt_lat_sys_jvp" title="Permalink to this definition"></a></dt>
<dd><p>This function is the JVP rule for the optimization
of the lattice system of a molecular simulation.
It calculates the Jacobian-vector product (JVP)
of the function opt_lat_sys_jaxopt using implicit differentiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primals</strong> (<em>-</em>) – a tuple of three inputs: <a href="#id23"><span class="problematic" id="id24">ff_</span></a> (force field parameters),</p></li>
<li><p><strong>configuration</strong> (<em>sys_int</em><em> (</em><em>an instance</em><em> of </em><em>the System class that contains the initial</em>) – </p></li>
<li><p><strong>system</strong><strong>)</strong> (<em>of the molecular</em>) – </p></li>
<li><p><strong>ffa</strong> (<em>and</em>) – </p></li>
<li><p><strong>tangents</strong> (<em>-</em>) – a tuple of three tangents that correspond to the derivatives</p></li>
<li><p><strong>ff</strong> (<em>of</em>) – </p></li>
<li><p><strong>sys_int</strong> – </p></li>
<li><p><strong>ffa</strong> – </p></li>
<li><p><strong>respectively.</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>an instance of the System class that contains the optimized
configuration of the molecular system.</p>
<ul class="simple">
<li><p>tangents_out: a tuple of three tangents that correspond to the derivatives</p></li>
</ul>
<p>of <a href="#id25"><span class="problematic" id="id26">ff_</span></a>, sys_int, and <a href="#id27"><span class="problematic" id="id28">ffa_</span></a> with respect to the optimized configuration
of the molecular system.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>primals_out</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.params_ewald">
<span id="delff-params-ewald-module"></span><h2>delff.params_ewald module<a class="headerlink" href="#module-delff.params_ewald" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.params_ewald.calc_kvecs_combinatorial">
<span class="sig-prename descclassname"><span class="pre">delff.params_ewald.</span></span><span class="sig-name descname"><span class="pre">calc_kvecs_combinatorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkmaxs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/params_ewald.html#calc_kvecs_combinatorial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.params_ewald.calc_kvecs_combinatorial" title="Permalink to this definition"></a></dt>
<dd><p>This function is a subroutine of calc_nkvecs calculating k vectors for Ewald summation using combinatorial method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – A System object representing the system to calculate k vectors for.</p></li>
<li><p><strong>nkmaxs</strong> (<em>Array</em>) – A tuple containing the maximum number of k-vectors in each direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing the k vectors for Ewald summation. The shape of the array is (num_kvecs,3).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nkvecs (Array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.params_ewald.calc_nkvecs">
<span class="sig-prename descclassname"><span class="pre">delff.params_ewald.</span></span><span class="sig-name descname"><span class="pre">calc_nkvecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/params_ewald.html#calc_nkvecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.params_ewald.calc_nkvecs" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the k vectors for Ewald summation
using combinatorial method and returns the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – A System object representing the system to calculate k vectors for.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – A ForceFieldAssignments</p></li>
<li><p><strong>alpha.</strong> (<em>object containing force field assignments including cutoff radius and</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing the k vectors for Ewald summation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nkvecs (Array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.params_ewald.define_ewald_params">
<span class="sig-prename descclassname"><span class="pre">delff.params_ewald.</span></span><span class="sig-name descname"><span class="pre">define_ewald_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></span><a class="reference internal" href="_modules/delff/params_ewald.html#define_ewald_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.params_ewald.define_ewald_params" title="Permalink to this definition"></a></dt>
<dd><p>This function defines Ewald parameters for a given system using the force field assignments
and returns the updated force field assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – A System object representing the system to calculate Ewald parameters for.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – A ForceFieldAssignments object containing force field assignments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated ForceFieldAssignments object with the calculated Ewald parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a href="#id29"><span class="problematic" id="id30">ffa_</span></a> (ForceFieldAssignments)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.rtp">
<span id="delff-rtp-module"></span><h2>delff.rtp module<a class="headerlink" href="#module-delff.rtp" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.alldists">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">alldists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sys_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#alldists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.alldists" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the distances between all atom pairs in a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys_0</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>sys_1</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – Another System object containing atomic coordinates. Usually, sys_0 is identical to sys_1.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distances between all atom pairs in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.alldists_neighbors">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">alldists_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#alldists_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.alldists_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the distances between neighboring atoms in a system, considering periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distances between neighboring atom pairs in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.angle_coord">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">angle_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#angle_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.angle_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the bond angles for a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bond angles for each angle in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.bond_coord">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">bond_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#bond_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.bond_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the bond lengths for a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bond lengths for each bond in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.dihedral_coord">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">dihedral_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#dihedral_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.dihedral_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the dihedral angles for a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dihedral angles for each dihedral in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.improper_coord">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">improper_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/rtp.html#improper_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.improper_coord" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the improper dihedral angles for a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Improper dihedral angles for each improper in the system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.xyz2rtp">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">xyz2rtp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></span><a class="reference internal" href="_modules/delff/rtp.html#xyz2rtp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.xyz2rtp" title="Permalink to this definition"></a></dt>
<dd><p>Converts Cartesian coordinates to internal coordinates (bond lengths, angles, dihedrals and impropers) for a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RTPCoord object containing the internal coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord">RTPCoord</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.rtp.xyz2rtp_lattice">
<span class="sig-prename descclassname"><span class="pre">delff.rtp.</span></span><span class="sig-name descname"><span class="pre">xyz2rtp_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffa_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><span class="pre">ForceFieldAssignments</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord"><span class="pre">RTPCoord</span></a></span></span><a class="reference internal" href="_modules/delff/rtp.html#xyz2rtp_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.rtp.xyz2rtp_lattice" title="Permalink to this definition"></a></dt>
<dd><p>Converts Cartesian coordinates to internal coordinates (all distances) in a periodic system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p></li>
<li><p><strong>ffa</strong> (<a class="reference internal" href="#delff.objects.ForceFieldAssignments" title="delff.objects.ForceFieldAssignments"><em>ForceFieldAssignments</em></a>) – ForceFieldAssignments object containing the force field assignments for each atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RTPCoord object containing the internal coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#delff.objects.RTPCoord" title="delff.objects.RTPCoord">RTPCoord</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff.util">
<span id="delff-util-module"></span><h2>delff.util module<a class="headerlink" href="#module-delff.util" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="delff.util.convert_tsr4_to_mat2">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">convert_tsr4_to_mat2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsr4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#convert_tsr4_to_mat2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.convert_tsr4_to_mat2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.doreg">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">doreg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#doreg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.doreg" title="Permalink to this definition"></a></dt>
<dd><p>Regulates the valuables of a given ForceField object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>reg</strong> (<em>array-like</em>) – Regulation factors for each attribute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new ForceField object with regulated attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField">ForceField</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.dounreg">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">dounreg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#dounreg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.dounreg" title="Permalink to this definition"></a></dt>
<dd><p>Reverse Regularization of the valuables of a given ForceField object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p></li>
<li><p><strong>reg</strong> (<em>array-like</em>) – Regulation factors for each attribute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new ForceField object with regulated attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField">ForceField</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.get_reciprocal_lattice_and_V">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">get_reciprocal_lattice_and_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#get_reciprocal_lattice_and_V"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.get_reciprocal_lattice_and_V" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the reciprocal lattice and volume of a given lattice.
ref: <a class="reference external" href="https://nanobuff.wordpress.com/2022/03/05/3d-and-2d-reciprocal-lattice-vectors-python-example/">https://nanobuff.wordpress.com/2022/03/05/3d-and-2d-reciprocal-lattice-vectors-python-example/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lattice</strong> (<em>Array</em>) – 3D array representing a lattice.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the reciprocal lattice (Array) and volume (float).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.isfloat">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">isfloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#isfloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.isfloat" title="Permalink to this definition"></a></dt>
<dd><p>Checks if the input string can be converted to a float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameter</strong> (<em>str</em>) – The string to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string can be converted to a float, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.jnp2np">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">jnp2np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bondtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angletypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedralks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impropertypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#jnp2np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.jnp2np" title="Permalink to this definition"></a></dt>
<dd><p>Converts multiple jax.numpy arrays into a single numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bondtypes</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>angletypes</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>dihedralks</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>impropertypes</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>pairs</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>charges</strong> (<em>Array</em>) – Jax numpy arrays representing various aspects of a molecular system.</p></li>
<li><p><strong>mask</strong> (<em>Array</em>) – Boolean mask for array selection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A single numpy array concatenating all input arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.logdamp">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">logdamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/util.html#logdamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.logdamp" title="Permalink to this definition"></a></dt>
<dd><p>Applies a logarithmic damping to the input jax.numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>Array</em>) – The input array.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – The scaling factor. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The damped array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.logdamp_np">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">logdamp_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/delff/util.html#logdamp_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.logdamp_np" title="Permalink to this definition"></a></dt>
<dd><p>Applies a logarithmic damping to the input numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>Array</em>) – The input array.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – The scaling factor. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The damped array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.make_lattice_replicas">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">make_lattice_replicas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sys_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#make_lattice_replicas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.make_lattice_replicas" title="Permalink to this definition"></a></dt>
<dd><p>Generates lattice replicas of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sys</strong> (<a class="reference internal" href="#delff.objects.System" title="delff.objects.System"><em>System</em></a>) – System object containing the atomic coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinates of all atoms in the replicated system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.np2jnp">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">np2jnp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbondtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nangletypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndihedraltypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimpropertypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars_ini_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#np2jnp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.np2jnp" title="Permalink to this definition"></a></dt>
<dd><p>Converts a jax array into multiple numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vars_new</strong> (<em>Array</em>) – A single numpy array containing all masked parameters in a Force Field.</p></li>
<li><p><strong>nbondtypes</strong> – numbers of the Force Field aprameters.</p></li>
<li><p><strong>nangletypes</strong> – numbers of the Force Field aprameters.</p></li>
<li><p><strong>ndihedraltypes</strong> – numbers of the Force Field aprameters.</p></li>
<li><p><strong>nimpropertypes</strong> – numbers of the Force Field aprameters.</p></li>
<li><p><strong>npairs</strong> – numbers of the Force Field aprameters.</p></li>
<li><p><strong>natom</strong> – numbers of atoms in a molecule corresponding to the Force Field.</p></li>
<li><p><strong>mask</strong> (<em>Array</em>) – Boolean mask for array selection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>jax.numpy arrays representing various aspects of a molecular system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bondtypes, angletypes, dihedralks, impropertypes, pairs, charges (Array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.print_jnpval">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">print_jnpval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#print_jnpval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.print_jnpval" title="Permalink to this definition"></a></dt>
<dd><p>Prints the jax.numpy object and numpy object adaptively</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> – jax.numpy or numpy array/list/tuple object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delff.util.printff">
<span class="sig-prename descclassname"><span class="pre">delff.util.</span></span><span class="sig-name descname"><span class="pre">printff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ff_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><span class="pre">ForceField</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/delff/util.html#printff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delff.util.printff" title="Permalink to this definition"></a></dt>
<dd><p>Prints the attributes of a given ForceField object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ff</strong> (<a class="reference internal" href="#delff.objects.ForceField" title="delff.objects.ForceField"><em>ForceField</em></a>) – ForceField object containing the parameters for the force field.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-delff">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-delff" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to delff’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hiroshi Nakano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>